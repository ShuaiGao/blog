(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{399:function(s,t,a){"use strict";a.r(t);var e=a(4),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redis"}},[s._v("#")]),s._v(" redis")]),s._v(" "),t("p",[s._v("Redis 是一个 key-value 存储数据结构服务器，是一个开源的使用 ANSI C 语言编写的，遵守 BSD 协议，支持网络可基于内存亦可持久化的日执行，key-value 数据库，并提供多种语言的 API。支持存储的值可以是字符串（string)，哈希（hash），列表（list），集合（set)，有序集合（sorted sets）。redis 有着复杂的数据结构并且提供对他们的原子操作。")]),s._v(" "),t("p",[s._v("相关资源: "),t("a",{attrs:{href:"https://redis.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Redis 官网"),t("OutboundLink")],1),s._v(" "),t("a",{attrs:{href:"http://try.redis.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Redis 在线测试"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"_1-从测试命令开始学习"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-从测试命令开始学习"}},[s._v("#")]),s._v(" 1. 从测试命令开始学习")]),s._v(" "),t("p",[s._v("redis 性能测试的基本命令如下")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("redis-benchmark [option] [option value]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("该命令在 redis 目录下执行，而不是在 redis 客户端内执行。以下示例同时执行 10000 个请求来检测性能")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("$ redis-benchmark "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),s._v("\n\nPING_INLINE: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22727.27")]),s._v(" requests per second\nPING_BULK: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24390.24")]),s._v(" requests per second\nSET: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23809.52")]),s._v(" requests per second\nGET: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21739.13")]),s._v(" requests per second\nINCR: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23809.52")]),s._v(" requests per second\nLPUSH: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21276.60")]),s._v(" requests per second\nRPUSH: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24390.24")]),s._v(" requests per second\nLPOP: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21739.13")]),s._v(" requests per second\nRPOP: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("55555.56")]),s._v(" requests per second\nSADD: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20000.00")]),s._v(" requests per second\nHSET: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24390.24")]),s._v(" requests per second\nSPOP: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23809.52")]),s._v(" requests per second\nLPUSH "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("needed to benchmark LRANGE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21739.13")]),s._v(" requests per second\nLRANGE_100 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("first "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" elements"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16949.15")]),s._v(" requests per second\nLRANGE_300 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("first "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v(" elements"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7575.76")]),s._v(" requests per second\nLRANGE_500 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("first "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("450")]),s._v(" elements"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6993.01")]),s._v(" requests per second\nLRANGE_600 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("first "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" elements"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5076.14")]),s._v(" requests per second\nMSET "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" keys"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19230.77")]),s._v(" requests per second\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("p",[s._v("从检测性能的命令上来学习 redis，"),t("em",[s._v("PING")]),s._v("命令用于测试服务端连接。redis 将返回 PONG。inline 和 bulk 区别，两者是相对于 redis 序列化协议（REdis Serialization Protocol, RESP）来说的 inline 就是一个单行，以空格来分隔命令的使用方式。例如在没有 redis-cli 的时候可以使用 telnet 命令临时代替操作。操作命令即 "),t("em",[s._v("telnet ip 6379")]),s._v("。另外当使用 redis 客户端或自己实现 redis 客户端的时候就会同时发送多行命令，RESP 使用 \\r\\n 来分割命令并且还会涉及到其他的特殊标记符号。")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("键管理命令\nSET、GET 命令等用于管理 redis 的键，相关的命令还有 DEL DUMP EXISTS EXPIRE EXPIREAT PEXPIRE PEXPIREAT KEYS MOVE PERSIST PTTL TTL RANDOMKEY RENAME RENAMENX TYPE")])]),s._v(" "),t("li",[t("p",[s._v("字符串和值命令\nINCR、MSET 字符串（String）和值（value）操作命令。相关的命令还有 GETRANGE GETSET GETBIT MGET SETBIT SETEX SETNX SETRANGE STRLEN MSET MSETNX PSETEX INCR INCRBY INCRBYFLOAT OECR OECRBY APPEND")])]),s._v(" "),t("li",[t("p",[s._v("列表操作命令\nLPUSH、RPUSH、LPOP、RPOP 列表(list)操作的命令，命令的含义基本就是字面意思了。相关的命令还有 BLPOP BRPOP BRPOPLPUSH LINDEX LINSERT LLEN LPOP LPUSHX LRANGE LREM LSET LTRIM RPOP RPOPLPUSH RPUSHX")])]),s._v(" "),t("li",[t("p",[s._v("集合命令\nSADD、SPOP 集合(set)操作的命令,这是一个无序集合，使用迭代功能时要注意。相关的命令还有 SCARD SDIFF SDIFFSTORE SINTER SINTERSTORE SISMEMBER SMEMBERS SMOVE SRANDOMEMEMBER SREM SUNION SUNIONSTORE SSCAN")])]),s._v(" "),t("li",[t("p",[s._v("有序集合命令\n集合分无序集合(set)和有序集合(sorted set)，上面的操作针对于无序集合。有序集合的操作命令有 ZADD ZCARD ZCOUNT ZINCRBY ZINTERSTORE ZLEXCOUNT ZRANGE ZRANGEBYLEX ZRANGEBYSCORE ZRANK ZREM ZREMRANGEBYLEX ZREMRANGEBYRANK ZREMRANGEBYSCORE ZREVRANGE ZREVRANGEBYSCORE ZREVRANK ZSCORE ZUNIONSTORE ZSCAN")])])]),s._v(" "),t("p",[s._v("可以看到有序集合支持众多复杂的操作，在应用中可以利用有序集合的排序能力做排行榜功能。")]),s._v(" "),t("h3",{attrs:{id:"_1-6-哈希命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-哈希命令"}},[s._v("#")]),s._v(" 1.6 哈希命令")]),s._v(" "),t("p",[s._v("HSET 哈希（Hash）操作。哈希是无序的，在使用迭代功能的时候要注意。相关命令还有 HDEL HEXIESTS HGET HGETALL HINCRBY HINCRBYFLOAT HKEYS HLEN HMGET HMSET HSET HSETNX HVALS HSCAN")]),s._v(" "),t("p",[s._v("上面 redis-benchmark 只是执行一些基本命令的性能测试，还可以自定义其他命令的性能测试，可使用 redis-benchmark --help 查看命令参数，自定义测试命令。")]),s._v(" "),t("h2",{attrs:{id:"_2-hyperloglog-基数统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-hyperloglog-基数统计"}},[s._v("#")]),s._v(" 2. HyperLogLog 基数统计")]),s._v(" "),t("p",[s._v("这是一个很 NB 的算法，虽然我还没搞懂算法的每一个细节，但是单一个抛硬币隐身出来的数学算法，让人不得不叹服数学之伟大。")]),s._v(" "),t("p",[s._v("基数统计，它用于统计输入元素的数量，而不会存储元素本身。在 Redis 里面，每个 HyperLogLog 键只需要 12k 内存，就可以计算将近 2^64 个不同元素的基数。")]),s._v(" "),t("p",[s._v("基数统计只有 3 个命令，如下")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("序号")]),s._v(" "),t("th",[s._v("命令")]),s._v(" "),t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("描述")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("1")]),s._v(" "),t("td",[s._v("PFADD")]),s._v(" "),t("td",[s._v("PFADD key element [element...]")]),s._v(" "),t("td",[s._v("添加指定元素到 HyperLogLog 中")])]),s._v(" "),t("tr",[t("td",[s._v("2")]),s._v(" "),t("td",[s._v("PFCOUNT")]),s._v(" "),t("td",[s._v("PFCOUNT key [key...]")]),s._v(" "),t("td",[s._v("返回给定 HyperLogLog 的基数估算值")])]),s._v(" "),t("tr",[t("td",[s._v("3")]),s._v(" "),t("td",[s._v("PFMERGE")]),s._v(" "),t("td",[s._v("PFMERGE destkey sourcekey [sourcekey...]")]),s._v(" "),t("td",[s._v("将多个 HyperLogLog 合并为一个 HyperLogLog")])])])]),s._v(" "),t("h2",{attrs:{id:"_3-发布订阅-pub-sub"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-发布订阅-pub-sub"}},[s._v("#")]),s._v(" 3. 发布订阅（pub/sub）")]),s._v(" "),t("p",[s._v("发布订阅是一种消息通信模式：发送者（pub）发送消息，订阅者（sub）接收消息。Redis 客户端可以订阅任意数量的频道。\n使用示例如下：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("redis "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" SUBSCRIBE redisChat  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 订阅redisChat频道")]),s._v("\n\nredis "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:638"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v(" PUBLISH redisChat "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布消息，在订阅频道可以接收到消息")]),s._v("\nredis "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:638"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v(" PUBLISH redisChat "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" world"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布消息，在订阅频道可以接收到消息")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("发布和订阅的其他命令\nPSUBSCRIBE PUBSUB PUBLISH SUBSCRIBE UNSUBSCRIBE")]),s._v(" "),t("h2",{attrs:{id:"_4-事务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-事务"}},[s._v("#")]),s._v(" 4. 事务")]),s._v(" "),t("p",[s._v("redis 的事务是一个让命令顺序执行的打包操作，它只保证命令执行中不会被插入其他命令执行，允许命令执行失败，在 EXEC 调用后才开始执行。Redis 的单个命令是原子的，但是 redis 的事务不是原子的，并且事务执行中发生错误，事务不会被回滚。")]),s._v(" "),t("p",[s._v("使用示例")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" a aaa\nQUEUED\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" b bbb\nQUEUED\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" c ccc\nQUEUED\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" OK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" OK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" OK\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("相关命令 DISCARD EXEC MULTI UNWATCH WATCH")]),s._v(" "),t("h2",{attrs:{id:"_5-redis-脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-redis-脚本"}},[s._v("#")]),s._v(" 5. Redis 脚本")]),s._v(" "),t("p",[s._v("Redis 脚本使用 Lua 解释器，执行脚本命令为 EVAL，命令语法如下")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" EVAL script numkey key "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("key "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" arg "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arg "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("实例")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" EVAL "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"return {KEYS[1],KEYS[2],ARGV[1],ARGV[2]}"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" key1 key2 first second\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"key1"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"key2"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"second"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v('相关命令 EVAL EVALSHA SCRIPT "SCRIPT FLUSH" "SCRIPT KILL" "SCRIPT LOAD"')]),s._v(" "),t("h2",{attrs:{id:"_6-redis-连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-redis-连接"}},[s._v("#")]),s._v(" 6. Redis 连接")]),s._v(" "),t("p",[s._v("命令比较简单，简单罗列一下 AUTH ECHO PING QUIT "),t("strong",[s._v("SELECT")])]),s._v(" "),t("p",[s._v("Redis 启动后默认有 16 个数据库(0-15)，使用 select 命令切换")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换到0号库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换到1号库")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" CONFIG get requirepass\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"requirepass"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置密码并授权登录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" CONFIG "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" requirepass "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gao"')]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" AUTH "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gao"')]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" CONFIG get requirepass\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"requirepass"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"runoob"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h2",{attrs:{id:"_7-redis-服务器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-redis-服务器"}},[s._v("#")]),s._v(" 7. Redis 服务器")]),s._v(" "),t("p",[s._v('服务器命令主要用于管理 redis 服务。命令比较多，罗列如下\nBGREWRITEAOF BGSAVE "CLIENT KILL" "CLIENT LIST" "CLIENT GETNAME" "CLIENT PAUSE" "CLIENT SETNAME" "CLUSTER SLOTS" COMMAND "COMMAND COUNT" "COMMAND GETKEYS" "TIME" "COMMAND INFO" "CONFIG GET" "CONFIG REWRITE" "CONFIG SET" "CONFIG RESETSTAT" DBSIZE "DBUG OBJECT" "DEBUG SEGFAULT" FLUSHALL FLUSHDB INFO LASTSAVE MONITOR ROLE SAVE "SHUTDOWN [NOSAVE][save]" SLAVEOF SLOWLOG SYNC')]),s._v(" "),t("h2",{attrs:{id:"_8-redis-数据备份和恢复"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-redis-数据备份和恢复"}},[s._v("#")]),s._v(" 8. Redis 数据备份和恢复")]),s._v(" "),t("p",[s._v("SAVE 命令用于创建当前数据库的备份，命令会创建 dump.rdb 并保存在 redis 的安装目录。查看安装目录可以使用命令"),t("em",[s._v("CONFIG GET dir")]),s._v("查看。redis 的数据库恢复，只要将备份文件拷贝到 redis 安装目录并启动服务即可。另外数据库的备份可使用 BGSAVE 在后台执行备份操作")]),s._v(" "),t("h2",{attrs:{id:"_9-管道和分区技术"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-管道和分区技术"}},[s._v("#")]),s._v(" 9. 管道和分区技术")]),s._v(" "),t("p",[s._v("通过管道执行 redis 命令")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-en")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PING'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v(" SET runoobkey redis"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("GET runoobkey"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("INCR visitor"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("INCR visitor"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("INCR visitor"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nc")]),s._v(" localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n\n+PONG\n+OK\nredis\n:1\n:2\n:3\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("python 中使用管道")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" redis\n\nr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localhost"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\npipe "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pipeline"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("transaction"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\npipe"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sad'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\npipe"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'age'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\npipe"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("execute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("管道的执行和事务很像，执行语句中有失败的查询，不会影响后面语句的执行。但是事务中如果有查询语法错误，会在事务执行之前报错，而管道不会。管道技术主要用于加速查询，事务技术用于确保查询的执行顺序和执行完整性（即都执行一遍，即使会出错）。")]),s._v(" "),t("p",[s._v("分区技术是减小单一数据连接线程负载的手段，通过对键值的唯一性哈希将特定的键存储到对应 redis 实例，一般是对哈希值进行取余运算来映射。")]),s._v(" "),t("ol",[t("li")])])}),[],!1,null,null,null);t.default=n.exports}}]);